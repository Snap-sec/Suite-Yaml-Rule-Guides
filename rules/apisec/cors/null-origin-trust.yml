rule_name: CORS Null Origin Trust
single_match: true
description: Detects if the application accepts 'null' as a valid origin.
transform:
  header:
    add:
      Origin: "null"
match_on:
  status: 200
  header:
    Access-Control-Allow-Origin: "null"
report:
  title: "CORS: Null Origin Trusted"
  description: |
    The application accepts the 'null' origin in the Access-Control-Allow-Origin header.

    This is dangerous because requests from local files, sandboxed iframes, and some redirects send the origin 'null'. An attacker can trick a user into opening a malicious local HTML file or using a sandboxed iframe to access the vulnerable application.

    Original Request:
    {{original}}

    Transformed Request:
    {{req}}

    Response:
    {{res}}

  cwe: "CWE-942"
  severity: medium
  cvssScore: "5.0"
  mitigation: |
    1. Do not whitelist the 'null' origin.
    2. Ensure that CORS configuration explicitly denies 'null'.
  stepsToReproduce: |
    1. Send request with 'Origin: null' to {{req.url}}
    2. Observe response header 'Access-Control-Allow-Origin: null'
  tags: "cors,misconfiguration,medium"
  impact: "Access from local files/sandboxed iframes"
