rule_name: Insecure Cookie: Missing Secure Flag
single_match: true
description: "Detects 'Set-Cookie' headers missing the 'Secure' attribute."
transform:
  method: ["GET"]
match_on:
  status: 200
  header:
    Set-Cookie:
      regex: "^(?!.*(?i)secure).*$"
report:
  title: "Insecure Cookie: Missing Secure Flag"
  description: |
    A cookie was set without the 'Secure' flag.
    This means the cookie can be transmitted over unencrypted HTTP connections, making it vulnerable to interception.

    Set-Cookie: {{res.headers.Set-Cookie}}

    Original Request:
    {{original}}

    Response:
    {{res}}

  cwe: "CWE-614"
  severity: medium
  cvssScore: "5.0"
  mitigation: |
    1. Set the 'Secure' flag on all sensitive cookies.
    2. Ensure the site is served over HTTPS.
  stepsToReproduce: |
    1. Send request to {{req.url}}
    2. Observe 'Set-Cookie' header lacks '; Secure'
  tags: "misconfiguration,cookie,medium"
  impact: "Session hijacking via side-jacking"
