rule_name: Server Information Disclosure
description: Detects if the server reveals detailed version information in 'Server' or 'X-Powered-By' headers.
transform:
  method: ["GET", "POST", "HEAD"]
match_on:
  status: 200
  headers:
    Server: 
      regex: ".*\\d+\\.\\d+.*" 
report:
  title: "Information Disclosure: Server Version"
  description: |
    The application discloses its server version in the 'Server' header.
    
    Revealed Header: Server
    Value: {{res.headers.Server}}

    Original Request:
    {{original}}

    Response:
    {{res}}

  cwe: "CWE-200"
  cvssScore: "5.3"
  mitigation: |
    1. Configure the server to suppress the 'Server' header or set it to a generic value (e.g. 'Apache').
    2. Remove 'X-Powered-By' headers.
  stepsToReproduce: |
    1. Send request to {{req.url}}
    2. Observe 'Server' header contains version numbers.
  tags: "misconfiguration,info-disclosure,low"
  impact: "Helps attackers target specific CVEs"
