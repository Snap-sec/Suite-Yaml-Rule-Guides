rule_name: Srcdoc Iframe XSS

transform:
  replace_params_one_by_one: "<script>alert(xss_srcdoc)</script>"

match_on:
  status: 200
  response_contains: "<iframe[^>]+srcdoc=[\"'][\\s\\S]*alert\\(xss_srcdoc\\)"

report:
  title: "Srcdoc Iframe XSS"
  description: "Iframe srcdoc XSS vulnerability detected"
  cwe: "CWE-79"
  cvssScore: "6.1"
  mitigation: "Sanitize iframe srcdoc content"
  stepsToReproduce: "Inject iframe XSS payload: {{req.url}}"
  tags: "xss,iframe,srcdoc,injection"
  impact: "Iframe content injection"
