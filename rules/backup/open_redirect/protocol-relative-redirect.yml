rule_name: Protocol Relative Redirect

transform:
  replace_params_one_by_one: "//evil.com"

match_on:
  status: [301, 302, 303, 307, 308]
  response_contains: "evil.com"

report:
  title: "Open Redirect - Protocol Relative"
  description: "Open redirect vulnerability detected via protocol relative URL"
  cwe: "CWE-601"
  cvssScore: "4.3"
  mitigation: "Validate redirect URLs against whitelist and block protocol relative URLs"
  stepsToReproduce: "Replace parameter with //evil.com: {{req.url}}"
  tags: "open-redirect,protocol-relative,url-validation"
  impact: "Phishing attacks and credential theft"
