rule_name: JWT Weaknesses - alg=none, missing exp, weak keys

transform:
  headers:
    add:
      Authorization: "Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIn0."
      Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIn0.weak"
      Authorization: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIn0."

match_on:
  status: 200
  content_type: "application/json"

report:
  title: "JWT Weaknesses Detected"
  description: "API accepted JWT with alg=none, missing exp, or weak keys"
  cwe: "CWE-345"
  cvssScore: "7.5"
  mitigation: "Validate JWT algorithm, expiration, and use strong keys"
  stepsToReproduce: "Send request with weak JWT: {{req.headers.Authorization}}"
  tags: "jwt,weak-algorithm,missing-expiration"
  impact: "JWT bypass via algorithm weaknesses"
